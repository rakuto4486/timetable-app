{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <div class="row">
    <div class="col-lg-8 offset-lg-2">

      <h2 class="mb-3">âœ… ç™»éŒ²æ¸ˆã¿ã®æˆç¸¾</h2>

      <div class="accordion" id="gradesAccordion">
        {% for grade in grades %}
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading{{ loop.index }}">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ loop.index }}" aria-expanded="false" aria-controls="collapse{{ loop.index }}">
              ğŸ“˜ {{ grade.class_name }} ï½œ 
              {% if grade.total_score is not none %}
                åˆè¨ˆï¼š{{ grade.total_score }}
              {% else %}
                ä»®è¨ˆï¼š
                {% set ns = namespace(subtotal=0, complete=true) %}
                {% for g in grade.items %}
                  {% if g.score is not none %}
                    {% set ns.subtotal = ns.subtotal + (g.score * (g.weight / 100)) %}
                  {% else %}
                    {% set ns.complete = false %}
                  {% endif %}
                {% endfor %}
                {{ ns.subtotal | round(1) }}ï¼ˆæœªå®Œï¼‰
              {% endif %}
            </button>
          </h2>
          <div id="collapse{{ loop.index }}" class="accordion-collapse collapse" aria-labelledby="heading{{ loop.index }}" data-bs-parent="#gradesAccordion">
            <div class="accordion-body">
              <ul>
                {% for item in grade.items %}
                <li>{{ item.name }}ï¼š{{ item.weight }}% ï¼ å¾—ç‚¹ï¼š
                  {% if item.score is not none %}{{ item.score }}{% else %}æœªå…¥åŠ›{% endif %}
                </li>
                {% endfor %}
              </ul>
              <div class="mt-2">
                <a href="{{ url_for('edit_grade', class_name=grade.class_name) }}" class="btn btn-primary btn-sm">ç·¨é›†</a>
                <a href="{{ url_for('delete_grade', class_name=grade.class_name) }}" class="btn btn-danger btn-sm">å‰Šé™¤</a>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

    </div>
  </div>
</div>
{% endblock %}
